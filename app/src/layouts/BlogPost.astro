---
import { Image } from "astro:assets";
import type { CollectionEntry } from "astro:content";
import FormattedDate from "~/components/ui/FormattedDate.astro";
import BaseLayout from "./BaseLayout.astro";

// We extend the type but make pubDate optional
type Props = CollectionEntry<"blog">["data"];

const { title, description, pubDate, updatedDate, heroImage } = Astro.props;
---

<BaseLayout
    title={title}
    description={description}
    image={heroImage}
    imageAlt={title}
    type="article"
    publishedTime={pubDate}
    updatedTime={updatedDate}
>
    <article>
        {
            heroImage && (
                <div class="hero-image">
                    <Image
                        width={1020}
                        height={510}
                        src={heroImage}
                        alt=""
                        loading="eager"
                    />
                </div>
            )
        }

        <header class="post-header">
            <div class="date-container">
                {pubDate && <FormattedDate date={pubDate} />}

                {
                    updatedDate && (
                        <span class="last-updated">
                            {pubDate ? "- Updated: " : "Updated: "}
                            <FormattedDate date={updatedDate} />
                        </span>
                    )
                }
            </div>
            <h1>{title}</h1>
            <hr />
        </header>

        <div class="prose">
            <slot />
        </div>
    </article>
</BaseLayout>

<style>
    article {
        max-width: var(--max-content-width);
    }

    .hero-image {
        margin-bottom: var(--spacing-large);

        & img {
            display: block;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            width: 100%;
            height: auto;
        }
    }

    .hero-image .post-header {
        text-align: center;
        margin-bottom: var(--spacing-large);
    }

    .date-container {
        color: rgb(var(--color-gray));
        font-size: 0.9rem;
    }

    .last-updated {
        font-style: italic;
    }
</style>
